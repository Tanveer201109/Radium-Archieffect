
<!-- Background Effects -->
<div class="fixed inset-0 z-0 overflow-hidden pointer-events-none bg-black">
  <!-- Moving Smoke/Blur Blobs -->
  <div class="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-red-900 rounded-full mix-blend-screen filter blur-[100px] opacity-20 animate-[drift_20s_infinite_alternate]"></div>
  <div class="absolute bottom-[-10%] right-[-10%] w-[60%] h-[60%] bg-zinc-800 rounded-full mix-blend-screen filter blur-[120px] opacity-30 animate-[drift_25s_infinite_alternate-reverse]"></div>
  <div class="absolute top-[40%] left-[30%] w-[40%] h-[40%] bg-[#ff003c] rounded-full mix-blend-overlay filter blur-[150px] opacity-10 animate-[drift_30s_infinite_linear]"></div>
</div>

<main class="relative z-10 flex flex-col h-screen max-h-screen w-full font-sans text-white">
  
  <!-- Header -->
  <header class="flex-none p-6 flex justify-between items-center border-b border-white/10 bg-black/40 backdrop-blur-md">
    <div class="flex items-center gap-3">
      <div class="w-3 h-3 bg-[#ff003c] rounded-full animate-pulse shadow-[0_0_10px_#ff003c]"></div>
      <h1 class="text-2xl font-bold tracking-widest uppercase">
        <span class="text-white">Radium</span><span class="text-[#ff003c]">Architect</span>
      </h1>
    </div>
    
    @if (generatedProject()) {
      <button (click)="reset()" class="px-4 py-2 text-sm text-gray-400 hover:text-white border border-white/10 hover:border-[#ff003c] rounded transition-all duration-300">
        NEW PROJECT
      </button>
    }
  </header>

  <!-- Content Area -->
  <div class="flex-1 overflow-hidden relative flex flex-col items-center justify-center p-4">
    
    <!-- Initial Prompt Interface -->
    @if (!generatedProject() && !isGenerating()) {
      <div class="w-full max-w-2xl flex flex-col gap-6 animate-[fadeIn_0.5s_ease-out]">
        <div class="text-center space-y-2 mb-8">
          <h2 class="text-4xl font-light tracking-tight">System Ready.</h2>
          <p class="text-white/50">Describe the software architecture you require.</p>
        </div>

        <div class="relative group">
          <div class="absolute -inset-0.5 bg-gradient-to-r from-[#ff003c] to-purple-600 rounded-lg blur opacity-30 group-hover:opacity-75 transition duration-1000 group-hover:duration-200"></div>
          <div class="relative bg-black rounded-lg border border-white/10 p-1">
            <textarea 
              [(ngModel)]="userPrompt"
              placeholder="E.g., A secure chat application using WebSockets..."
              class="w-full h-32 bg-transparent text-lg p-4 focus:outline-none resize-none placeholder-white/20 text-white font-light"
            ></textarea>
            
            <div class="flex justify-between items-center p-2 border-t border-white/5">
              <button 
                (click)="toggleRecording()"
                [class.text-[#ff003c]]="isRecording()"
                [class.animate-pulse]="isRecording()"
                class="p-3 rounded-full hover:bg-white/5 transition-colors text-white/60 hover:text-[#ff003c]"
                title="Voice Input"
              >
                <!-- Mic Icon -->
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/></svg>
              </button>

              <button 
                (click)="generateSoftware()"
                [disabled]="!userPrompt().trim()"
                class="bg-[#ff003c] text-black font-bold py-2 px-6 rounded hover:bg-[#ff3366] disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-[0_0_15px_rgba(255,0,60,0.4)] hover:shadow-[0_0_25px_rgba(255,0,60,0.6)]"
              >
                INITIATE
              </button>
            </div>
          </div>
        </div>

        @if (error()) {
          <div class="text-red-500 bg-red-950/30 border border-red-500/30 p-4 rounded text-center backdrop-blur-sm">
            {{ error() }}
          </div>
        }
      </div>
    }

    <!-- Loading State -->
    @if (isGenerating()) {
      <div class="flex flex-col items-center gap-6">
        <div class="relative w-24 h-24">
          <div class="absolute inset-0 rounded-full border-2 border-t-[#ff003c] border-r-transparent border-b-transparent border-l-transparent animate-spin"></div>
          <div class="absolute inset-2 rounded-full border-2 border-b-[#ff003c] border-t-transparent border-l-transparent border-r-transparent animate-spin direction-reverse duration-700"></div>
          <div class="absolute inset-0 flex items-center justify-center">
            <div class="w-2 h-2 bg-[#ff003c] rounded-full animate-ping"></div>
          </div>
        </div>
        <div class="text-[#ff003c] font-mono tracking-widest animate-pulse">ARCHITECTING SOLUTION...</div>
        <div class="text-xs text-white/40 font-mono">
          Compiling Requirements <br>
          Analyzing Dependencies <br>
          Generating File Matrix
        </div>
      </div>
    }

    <!-- Project View Interface -->
    @if (generatedProject()) {
      <div class="w-full h-full flex gap-4 p-2 max-w-7xl animate-[fadeIn_0.5s_ease-out]">
        
        <!-- Sidebar -->
        <div class="w-64 flex-none flex flex-col bg-black/60 border border-white/10 rounded-lg backdrop-blur-md overflow-hidden">
          <div class="p-4 border-b border-white/10 bg-white/5">
            <h3 class="font-bold text-sm text-white/80 uppercase tracking-wider">Project Files</h3>
          </div>
          <div class="flex-1 overflow-y-auto p-2 space-y-1">
            @for (file of generatedProject()?.files; track file.name) {
              <button 
                (click)="selectFile(file)"
                class="w-full text-left px-3 py-2 rounded text-sm font-mono transition-all duration-200 border border-transparent"
                [class.bg-[#ff003c]/20]="selectedFile() === file"
                [class.text-[#ff003c]]="selectedFile() === file"
                [class.border-[#ff003c]/30]="selectedFile() === file"
                [class.text-gray-400]="selectedFile() !== file"
                [class.hover:bg-white/5]="selectedFile() !== file"
                [class.hover:text-white]="selectedFile() !== file"
              >
                {{ file.name }}
              </button>
            }
          </div>
        </div>

        <!-- Code Editor -->
        <div class="flex-1 flex flex-col bg-[#0a0a0a] border border-white/10 rounded-lg overflow-hidden shadow-2xl relative">
          <!-- Editor Header -->
          <div class="flex items-center justify-between px-4 py-2 bg-[#111] border-b border-white/10">
            <span class="text-sm text-gray-400 font-mono">{{ selectedFile()?.name }}</span>
            <div class="flex items-center gap-2">
              <span class="text-xs text-gray-600 uppercase">{{ selectedFile()?.language }}</span>
              <button (click)="copyCode()" class="p-1.5 hover:bg-white/10 rounded text-gray-400 hover:text-white transition-colors" title="Copy Code">
                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
              </button>
            </div>
          </div>

          <!-- Editor Body -->
          <div class="flex-1 overflow-auto relative custom-scrollbar bg-[#050505]/80">
            <pre class="p-4 text-sm font-mono leading-relaxed"><code class="language-{{selectedFile()?.language}} text-gray-300">{{ selectedFile()?.content }}</code></pre>
          </div>
          
          <!-- Decorative Bottom Bar -->
          <div class="h-1 w-full bg-gradient-to-r from-transparent via-[#ff003c] to-transparent opacity-50"></div>
        </div>

      </div>
    }

  </div>
  
  <!-- Footer Status Bar -->
  <footer class="flex-none py-1 px-4 border-t border-white/10 bg-black/80 backdrop-blur text-[10px] text-gray-500 font-mono flex justify-between uppercase tracking-widest">
    <div>Radium OS v1.0.4</div>
    <div class="flex gap-4">
      <span class="flex items-center gap-1">
        <span class="w-1.5 h-1.5 rounded-full bg-green-500"></span> Online
      </span>
      <span>Latency: 12ms</span>
      <span>Mem: 45%</span>
    </div>
  </footer>

</main>
